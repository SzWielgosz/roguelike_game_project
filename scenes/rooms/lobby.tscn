[gd_scene load_steps=16 format=3 uid="uid://eq5ww7lt7rbb"]

[ext_resource type="Script" path="res://scripts/rooms/lobby.gd" id="1_n2gji"]
[ext_resource type="PackedScene" uid="uid://clui5w1y5f5cb" path="res://scenes/ui/pause_menu.tscn" id="2_xi2gt"]
[ext_resource type="TileSet" uid="uid://djw8f0o58mryj" path="res://assets/art/tilemaps/new_general.tres" id="3_2cdy0"]
[ext_resource type="Script" path="res://scripts/main/spawn_point.gd" id="4_nypvo"]
[ext_resource type="PackedScene" uid="uid://d06uia2xoesnx" path="res://scenes/characters/player.tscn" id="5_8u260"]
[ext_resource type="Script" path="res://scenes/rooms/shop.gd" id="6_7fh1u"]
[ext_resource type="PackedScene" uid="uid://cyuu1n1siygd0" path="res://scenes/characters/alchemist.tscn" id="6_l8304"]
[ext_resource type="Texture2D" uid="uid://m04uxgubymal" path="res://assets/art/v1.1 dungeon crawler 16X16 pixel pack/ui (new)/background.png" id="6_oxfht"]
[ext_resource type="Texture2D" uid="uid://bv0tbu73fjmw8" path="res://assets/art/v1.1 dungeon crawler 16X16 pixel pack/tiles/floor/stair_nextlevel.png" id="7_p685w"]
[ext_resource type="Texture2D" uid="uid://cav6343qponyg" path="res://assets/art/v1.1 dungeon crawler 16X16 pixel pack/props_items/coin.png" id="8_45x56"]
[ext_resource type="Script" path="res://scripts/main/game_teleport.gd" id="8_t6811"]
[ext_resource type="FontFile" uid="uid://qkq8p3y1rws1" path="res://assets/fonts/EditUndo/editundo.ttf" id="9_qq0wh"]
[ext_resource type="Script" path="res://scripts/ui/communicates.gd" id="10_hvcb6"]
[ext_resource type="PackedScene" uid="uid://fyqb4k5vrm4b" path="res://scenes/ui/background.tscn" id="11_kliti"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_85ljd"]
size = Vector2(16, 16)

[node name="Lobby" type="Node2D"]
script = ExtResource("1_n2gji")

[node name="TileMap" type="TileMap" parent="."]
tile_set = ExtResource("3_2cdy0")
format = 2
layer_0/name = "floor"
layer_0/tile_data = PackedInt32Array(65536, 327680, 9, 131072, 327680, 9, 196608, 327680, 9, 262144, 327680, 9, 327680, 327680, 9, 393216, 327680, 9, 458752, 327680, 9, 524288, 327680, 9, 589824, 327680, 9, 655360, 327680, 9, 0, 524288, 8, 1, 524288, 8, 2, 524288, 8, 3, 524288, 8, 4, 524288, 8, 5, 524288, 8, 6, 524288, 8, 7, 524288, 8, 8, 524288, 8, 9, 524288, 8, 10, 524288, 8, 11, 524288, 8, 12, 524288, 8, 13, 524288, 8, 14, 524288, 8, 15, 524288, 8, 16, 524288, 8, 17, 524288, 8, 65553, 720896, 9, 131089, 720896, 9, 196625, 720896, 9, 262161, 720896, 9, 327697, 720896, 9, 393233, 720896, 9, 458769, 720896, 9, 524305, 720896, 9, 589841, 720896, 9, 655377, 720896, 9, 720896, 524288, 11, 720897, 524288, 11, 720898, 524288, 11, 720899, 524288, 11, 720900, 524288, 11, 720901, 524288, 11, 720902, 524288, 11, 720903, 524288, 11, 720904, 524288, 11, 720905, 524288, 11, 720906, 524288, 11, 720907, 524288, 11, 720908, 524288, 11, 720909, 524288, 11, 720910, 524288, 11, 720911, 524288, 11, 720912, 524288, 11, 720913, 524288, 11, 65537, 131072, 1, 131073, 131072, 1, 196609, 131072, 1, 262145, 131072, 1, 327681, 131072, 1, 393217, 131072, 1, 458753, 131072, 1, 524289, 131072, 1, 589825, 131072, 1, 655361, 131072, 1, 655362, 131072, 1, 655363, 131072, 1, 655364, 131072, 1, 655365, 131072, 1, 655366, 131072, 1, 655367, 131072, 1, 655368, 131072, 1, 655369, 131072, 1, 655370, 131072, 1, 655371, 131072, 1, 655372, 131072, 1, 655373, 131072, 1, 655374, 131072, 1, 655375, 131072, 1, 655376, 131072, 1, 589840, 131072, 1, 524304, 131072, 1, 458768, 131072, 1, 393232, 131072, 1, 327696, 131072, 1, 262160, 131072, 1, 196624, 131072, 1, 131088, 131072, 1, 65552, 131072, 1, 65551, 131072, 1, 65550, 131072, 1, 65549, 131072, 1, 65548, 131072, 1, 65547, 131072, 1, 65546, 131072, 1, 65545, 131072, 1, 65544, 131072, 1, 65543, 131072, 1, 65542, 131072, 1, 65541, 131072, 1, 65540, 131072, 1, 65539, 131072, 1, 65538, 131072, 1, 131074, 131072, 1, 196610, 131072, 1, 262146, 131072, 1, 327682, 131072, 1, 393218, 131072, 1, 458754, 131072, 1, 524290, 131072, 1, 589826, 131072, 1, 589827, 131072, 1, 589828, 131072, 1, 589829, 131072, 1, 589830, 131072, 1, 589831, 131072, 1, 589832, 131072, 1, 589833, 131072, 1, 589834, 131072, 1, 589835, 131072, 1, 589836, 131072, 1, 589837, 131072, 1, 589838, 131072, 1, 589839, 131072, 1, 131075, 131072, 1, 196611, 131072, 1, 262147, 131072, 1, 327683, 131072, 1, 393219, 131072, 1, 458755, 131072, 1, 524291, 131072, 1, 524292, 131072, 1, 524293, 131072, 1, 524294, 131072, 1, 524295, 131072, 1, 524296, 131072, 1, 524297, 131072, 1, 524298, 131072, 1, 524299, 131072, 1, 524300, 131072, 1, 524301, 131072, 1, 524302, 131072, 1, 524303, 131072, 1, 458767, 131072, 1, 393231, 131072, 1, 327695, 131072, 1, 262159, 131072, 1, 196623, 131072, 1, 196622, 131072, 1, 131086, 131072, 1, 131085, 131072, 1, 131084, 131072, 1, 131083, 131072, 1, 131082, 131072, 1, 131081, 131072, 1, 131080, 131072, 1, 131079, 131072, 1, 131078, 131072, 1, 131077, 131072, 1, 131076, 131072, 1, 196612, 131072, 1, 262148, 131072, 1, 327684, 131072, 1, 327685, 131072, 1, 393221, 131072, 1, 458757, 131072, 1, 458758, 131072, 1, 458759, 131072, 1, 458760, 131072, 1, 458761, 131072, 1, 458762, 131072, 1, 458763, 131072, 1, 458764, 131072, 1, 458765, 131072, 1, 458766, 131072, 1, 393230, 131072, 1, 393229, 131072, 1, 393228, 131072, 1, 393227, 131072, 1, 393226, 131072, 1, 393225, 131072, 1, 393224, 131072, 1, 393223, 131072, 1, 393222, 131072, 1, 393220, 131072, 1, 458756, 131072, 1, 262150, 131072, 1, 262151, 131072, 1, 196615, 131072, 1, 196616, 131072, 1, 262149, 131072, 1, 196613, 131072, 1, 196614, 131072, 1, 262152, 131072, 1, 327688, 131072, 1, 327687, 131072, 1, 327686, 131072, 1, 262153, 131072, 1, 262154, 131072, 1, 262155, 131072, 1, 327689, 131072, 1, 196617, 131072, 1, 196618, 131072, 1, 196619, 131072, 1, 196620, 131072, 1, 262156, 131072, 1, 327691, 131072, 1, 327690, 131072, 1, 196621, 131072, 1, 262157, 131072, 1, 327693, 131072, 1, 327692, 131072, 1, 262158, 131072, 1, 327694, 131072, 1, 131087, 131072, 1)
layer_1/name = "wall"
layer_1/tile_data = PackedInt32Array(-65536, 65536, 6, -65535, 65536, 6, -65534, 65536, 6, -65533, 65536, 6, -65532, 65536, 6, -65531, 65536, 6, -65530, 65536, 6, -65529, 65536, 6, -65528, 65536, 6, -65525, 65536, 6, -65524, 65536, 6, -65523, 65536, 6, -65526, 65536, 6, -65527, 65536, 6, -65522, 65536, 6, -65521, 65536, 6, -65520, 65536, 6, -65519, 65536, 6, 17, 196608, 5, 65553, 196608, 5, 131089, 196608, 5, 196625, 196608, 5, 262161, 196608, 5, 327697, 196608, 5, 393233, 196608, 5, 458769, 196608, 5, 524305, 196608, 5, 589841, 196608, 5, 655377, 196608, 5, 720913, 262144, 7, 720896, 0, 7, 655360, 131072, 5, 589824, 131072, 5, 524288, 131072, 5, 458752, 131072, 5, 393216, 131072, 5, 327680, 131072, 5, 262144, 131072, 5, 196608, 131072, 5, 131072, 131072, 5, 65536, 131072, 5, 0, 131072, 5, 720897, 65536, 7, 720898, 65536, 7, 720899, 65536, 7, 720900, 65536, 7, 720901, 65536, 7, 720902, 65536, 7, 720903, 65536, 7, 720904, 65536, 7, 720905, 65536, 7, 720906, 65536, 7, 720907, 65536, 7, 720908, 65536, 7, 720909, 65536, 7, 720910, 65536, 7, 720911, 65536, 7, 720912, 65536, 7)
layer_2/name = "furniture"
layer_2/tile_data = PackedInt32Array(196611, 589824, 1342177280, 262147, 0, 1342177281, 327683, 0, 1342177281, 393219, 0, 1342177281, 458755, 0, 1342177281, 524291, 720896, 1342177280)
layer_3/name = "items"
layer_3/tile_data = PackedInt32Array(1, 262144, 0, 16, 262144, 0, 4, 262144, 0, 7, 262144, 0, 10, 262144, 0, 13, 262144, 0)

[node name="SpawnPoint" type="Marker2D" parent="."]
position = Vector2(151, 95)
script = ExtResource("4_nypvo")
player = ExtResource("5_8u260")

[node name="Alchemist" parent="." node_paths=PackedStringArray("shop") instance=ExtResource("6_l8304")]
position = Vector2(41, 91)
shop = NodePath("Shop")

[node name="Shop" type="CanvasLayer" parent="Alchemist"]
visible = false
script = ExtResource("6_7fh1u")

[node name="Control" type="Control" parent="Alchemist/Shop"]
layout_mode = 3
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -20.0
offset_top = -20.0
offset_right = 20.0
offset_bottom = 20.0
grow_horizontal = 2
grow_vertical = 2

[node name="NinePatchRect" type="NinePatchRect" parent="Alchemist/Shop/Control"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -175.0
offset_top = -175.0
offset_right = 175.0
offset_bottom = 175.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("6_oxfht")

[node name="Label" type="Label" parent="Alchemist/Shop/Control/NinePatchRect"]
layout_mode = 1
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -39.5
offset_top = 30.0
offset_right = 39.5
offset_bottom = 53.0
grow_horizontal = 2
size_flags_horizontal = 4
text = "Spell shop"

[node name="ItemList" type="ItemList" parent="Alchemist/Shop/Control/NinePatchRect"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 27.0
offset_top = 51.0
offset_right = -27.0
offset_bottom = -61.0
grow_horizontal = 2
grow_vertical = 2
same_column_width = true

[node name="DepositedCoinsCounter" type="Label" parent="Alchemist/Shop/Control/NinePatchRect"]
layout_mode = 0
offset_left = 297.0
offset_top = 28.0
offset_right = 316.0
offset_bottom = 51.0
text = "00"

[node name="TextureRect" type="TextureRect" parent="Alchemist/Shop/Control/NinePatchRect"]
layout_mode = 0
offset_left = 274.0
offset_top = 27.0
offset_right = 299.0
offset_bottom = 52.0
texture = ExtResource("8_45x56")

[node name="CloseButton" type="Button" parent="Alchemist/Shop/Control/NinePatchRect"]
layout_mode = 1
anchors_preset = 7
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
offset_left = -22.0
offset_top = -60.0
offset_right = 26.0
offset_bottom = -29.0
grow_horizontal = 2
grow_vertical = 0
text = "close"

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(100, 100)
zoom = Vector2(2.5, 2.5)

[node name="GameTeleport" type="Sprite2D" parent="."]
position = Vector2(246, 93)
texture = ExtResource("7_p685w")
script = ExtResource("8_t6811")

[node name="Area2D" type="Area2D" parent="GameTeleport"]
collision_mask = 12

[node name="CollisionShape2D" type="CollisionShape2D" parent="GameTeleport/Area2D"]
shape = SubResource("RectangleShape2D_85ljd")

[node name="Label" type="Label" parent="GameTeleport"]
visible = false
offset_left = -44.0
offset_top = -18.0
offset_right = 1776.0
offset_bottom = 95.0
scale = Vector2(0.05, 0.05)
theme_override_fonts/font = ExtResource("9_qq0wh")
theme_override_font_sizes/font_size = 128
text = "press e to enter the dungeon"

[node name="PauseMenu" parent="." instance=ExtResource("2_xi2gt")]
visible = false

[node name="Communicates" type="CanvasLayer" parent="."]
script = ExtResource("10_hvcb6")

[node name="GameNotSaved" type="Control" parent="Communicates"]
visible = false
layout_mode = 3
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -20.0
offset_right = 20.0
offset_bottom = 40.0
grow_horizontal = 2

[node name="Label" type="Label" parent="Communicates/GameNotSaved"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -253.0
offset_top = -11.5
offset_right = 253.0
offset_bottom = 11.5
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("9_qq0wh")
theme_override_font_sizes/font_size = 21
text = "You cannot save the game in room with monsters"
horizontal_alignment = 1

[node name="ColorRect" type="ColorRect" parent="Communicates/GameNotSaved/Label"]
z_index = -1
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="GameSaved" type="Control" parent="Communicates"]
visible = false
layout_mode = 3
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -20.0
offset_right = 20.0
offset_bottom = 40.0
grow_horizontal = 2

[node name="Label" type="Label" parent="Communicates/GameSaved"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -253.0
offset_top = -11.5
offset_right = 253.0
offset_bottom = 11.5
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("9_qq0wh")
theme_override_font_sizes/font_size = 21
text = "Game succesfully saved"
horizontal_alignment = 1

[node name="ColorRect" type="ColorRect" parent="Communicates/GameSaved/Label"]
z_index = -1
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="ItemPopup" type="Control" parent="Communicates"]
visible = false
layout_mode = 3
anchors_preset = 5
anchor_left = 0.5
anchor_right = 0.5
offset_left = -20.0
offset_right = 20.0
offset_bottom = 40.0
grow_horizontal = 2

[node name="Label" type="Label" parent="Communicates/ItemPopup"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -253.0
offset_top = -11.5
offset_right = 253.0
offset_bottom = 11.5
grow_horizontal = 2
grow_vertical = 2
theme_override_fonts/font = ExtResource("9_qq0wh")
theme_override_font_sizes/font_size = 21
horizontal_alignment = 1

[node name="ColorRect" type="ColorRect" parent="Communicates/ItemPopup/Label"]
z_index = -1
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="ItemPopupVisibilityTimer" type="Timer" parent="Communicates/ItemPopup"]
wait_time = 2.0
one_shot = true

[node name="VisibilityTimer" type="Timer" parent="Communicates"]
wait_time = 2.0
one_shot = true

[node name="Background" parent="." instance=ExtResource("11_kliti")]
layer = -1

[connection signal="item_selected" from="Alchemist/Shop/Control/NinePatchRect/ItemList" to="Alchemist/Shop" method="_on_item_list_item_selected"]
[connection signal="pressed" from="Alchemist/Shop/Control/NinePatchRect/CloseButton" to="Alchemist/Shop" method="_on_close_button_pressed"]
[connection signal="body_entered" from="GameTeleport/Area2D" to="GameTeleport" method="_on_area_2d_body_entered"]
[connection signal="body_exited" from="GameTeleport/Area2D" to="GameTeleport" method="_on_area_2d_body_exited"]
[connection signal="timeout" from="Communicates/VisibilityTimer" to="Communicates" method="_on_visibility_timer_timeout"]
